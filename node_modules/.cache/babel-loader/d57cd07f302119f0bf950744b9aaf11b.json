{"ast":null,"code":"import _regeneratorRuntime from\"C:/Users/Rokas/Desktop/rrloto \\u2013 kopija/frontend/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"C:/Users/Rokas/Desktop/rrloto \\u2013 kopija/frontend/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"C:/Users/Rokas/Desktop/rrloto \\u2013 kopija/frontend/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React,{useEffect,useState}from'react';import axios from'axios';import Table from'react-bootstrap/Table';import{useNavigate}from'react-router-dom';import CancelModal from'../Components/CancelModal';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";var Admin=function Admin(){var _data$orders;var navigate=useNavigate();var sessionToken=sessionStorage.getItem(\"loggedIn\");var _useState=useState({}),_useState2=_slicedToArray(_useState,2),data=_useState2[0],setData=_useState2[1];var _useState3=useState(''),_useState4=_slicedToArray(_useState3,2),msg=_useState4[0],setMsg=_useState4[1];var _useState5=useState(false),_useState6=_slicedToArray(_useState5,2),showCancelModal=_useState6[0],setShowCancelModal=_useState6[1];var _useState7=useState(''),_useState8=_slicedToArray(_useState7,2),orderId=_useState8[0],setOrderId=_useState8[1];var _useState9=useState(''),_useState10=_slicedToArray(_useState9,2),searchQuery=_useState10[0],setSearchQuery=_useState10[1];useEffect(function(){if(!sessionToken){navigate('/login');}var getData=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(){var _yield$axios$get,res;return _regeneratorRuntime().wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return axios.get('http://localhost:8000/api/admin');case 2:_yield$axios$get=_context.sent;res=_yield$axios$get.data;setData(res);case 5:case\"end\":return _context.stop();}}},_callee);}));return function getData(){return _ref.apply(this,arguments);};}();getData();},[msg]);var handleAccept=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee2(data){return _regeneratorRuntime().wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.next=2;return axios.post(\"http://localhost:8000/api/admin/confirm/\".concat(data)).then(function(res){setMsg(res.data.success);}).catch(function(err){console.log(err);});case 2:case\"end\":return _context2.stop();}}},_callee2);}));return function handleAccept(_x){return _ref2.apply(this,arguments);};}();var handleCancel=function handleCancel(value){setOrderId(value);setShowCancelModal(true);};var handleClick=/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee3(){return _regeneratorRuntime().wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:case\"end\":return _context3.stop();}}},_callee3);}));return function handleClick(){return _ref3.apply(this,arguments);};}();return/*#__PURE__*/_jsx(_Fragment,{children:sessionToken&&/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(CancelModal,{showCancelModal:showCancelModal,setShowCancelModal:setShowCancelModal,orderId:orderId,setMsg:setMsg}),/*#__PURE__*/_jsx(\"div\",{className:\"container d-flex admin-panel justify-content-center\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"card card-ticket text-center\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"card-header\",children:\"Admin\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"card-body\",children:[/*#__PURE__*/_jsx(\"div\",{class:\"input-group\",children:/*#__PURE__*/_jsx(\"div\",{class:\"form-outline\",children:/*#__PURE__*/_jsx(\"input\",{type:\"search\",class:\"form-control\",placeholder:\"search\",onChange:function onChange(e){return setSearchQuery(e.target.value);}})})}),/*#__PURE__*/_jsx(\"div\",{class:\"input-group\",children:/*#__PURE__*/_jsx(\"button\",{onClick:handleClick})}),/*#__PURE__*/_jsxs(Table,{striped:true,bordered:true,children:[/*#__PURE__*/_jsx(\"thead\",{children:/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"th\",{children:\"ID\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Name,Lastname\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Action\"})]})}),/*#__PURE__*/_jsx(\"tbody\",{children:(_data$orders=data.orders)===null||_data$orders===void 0?void 0:_data$orders.filter(function(order){return order.order_nr.includes(searchQuery)||order.tickets[0].name.includes(searchQuery)||order.tickets[0].lastname.includes(searchQuery);}).map(function(order){return/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"td\",{children:order.order_nr}),/*#__PURE__*/_jsxs(\"td\",{children:[order.tickets[0].name,\" \",order.tickets[0].lastname]}),/*#__PURE__*/_jsxs(\"td\",{children:[order.active===0&&/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"button\",{className:\"btn btn-primary admin-table\",onClick:function onClick(){return handleAccept(order.id);},children:\"Accept\"}),/*#__PURE__*/_jsx(\"button\",{className:\"btn btn-primary admin-table\",onClick:function onClick(){return handleCancel(order.id);},children:\"Cancel\"})]}),order.active===1&&/*#__PURE__*/_jsx(\"p\",{children:\"Aktyvuotas\"}),order.active===2&&/*#__PURE__*/_jsx(\"p\",{children:\"At\\u0161auktas\"})]})]},order.id);})})]})]})]})})]})});};export default Admin;","map":{"version":3,"names":["React","useEffect","useState","axios","Table","useNavigate","CancelModal","Admin","navigate","sessionToken","sessionStorage","getItem","data","setData","msg","setMsg","showCancelModal","setShowCancelModal","orderId","setOrderId","searchQuery","setSearchQuery","getData","get","res","handleAccept","post","then","success","catch","err","console","log","handleCancel","value","handleClick","e","target","orders","filter","order","order_nr","includes","tickets","name","lastname","map","active","id"],"sources":["C:/Users/Rokas/Desktop/rrloto – kopija/frontend/src/Pages/Admin.jsx"],"sourcesContent":["import React, { useEffect, useState } from 'react';\r\nimport axios from 'axios';\r\nimport Table from 'react-bootstrap/Table';\r\nimport { useNavigate } from 'react-router-dom'\r\nimport CancelModal from '../Components/CancelModal';\r\n \r\n\r\nconst Admin = () => {\r\n\r\n    const navigate = useNavigate();\r\n    const sessionToken = sessionStorage.getItem(\"loggedIn\");\r\n    const [data, setData] = useState({});\r\n    const [msg, setMsg] = useState('');\r\n    const [showCancelModal, setShowCancelModal] = useState(false);\r\n    const [orderId, setOrderId] = useState('');\r\n    const [searchQuery, setSearchQuery] = useState('');\r\n\r\n    useEffect(() => {\r\n        if(!sessionToken)\r\n        {\r\n            navigate('/login');\r\n        }\r\n        const getData = async () => {\r\n            const {data: res} = await axios.get('http://localhost:8000/api/admin');\r\n            setData(res);\r\n        }\r\n        getData();\r\n    }, [msg])\r\n    \r\n    const handleAccept = async (data) => {\r\n        await axios.post(`http://localhost:8000/api/admin/confirm/${data}`)\r\n        .then((res) => {\r\n            setMsg(res.data.success)\r\n        })\r\n        .catch((err)=>{console.log(err)})\r\n    }\r\n\r\n    const handleCancel = (value) => {\r\n        setOrderId(value);\r\n        setShowCancelModal(true);\r\n    }\r\n\r\n    const handleClick = async() => {\r\n        \r\n        // await axios.post(`http://localhost:8000/api/admin/get-winner`)\r\n        // .then((res) => {\r\n        //     setMsg(res.data.success)\r\n        // })\r\n        // .catch((err)=>{console.log(err)})\r\n    }\r\n\r\n    return(\r\n        <>\r\n            {sessionToken &&\r\n            <>\r\n                <CancelModal showCancelModal={showCancelModal} setShowCancelModal={setShowCancelModal} orderId={orderId} setMsg={setMsg}/>\r\n                <div className='container d-flex admin-panel justify-content-center'>\r\n                    <div className=\"card card-ticket text-center\">\r\n                        <div className=\"card-header\">\r\n                            Admin\r\n                        </div>\r\n                        <div className='card-body'>\r\n                        <div class=\"input-group\">\r\n                            <div class=\"form-outline\">\r\n                                <input \r\n                                    type=\"search\" \r\n                                    class=\"form-control\" \r\n                                    placeholder='search'\r\n                                    onChange={(e) => setSearchQuery(e.target.value)}\r\n                                />\r\n                            </div>\r\n                        </div>\r\n                        <div class=\"input-group\">\r\n                            <button\r\n                            onClick={handleClick}\r\n                            >\r\n\r\n                            </button>\r\n                        </div>\r\n                            <Table striped bordered>\r\n                                <thead>\r\n                                    <tr>\r\n                                    <th>ID</th>\r\n                                    <th>Name,Lastname</th>\r\n                                    <th>Action</th>\r\n                                    </tr>\r\n                                </thead>\r\n                                <tbody>\r\n                                    {data.orders?.filter((order) => \r\n                                        order.order_nr.includes(searchQuery) ||\r\n                                        order.tickets[0].name.includes(searchQuery) ||\r\n                                        order.tickets[0].lastname.includes(searchQuery) \r\n                                        ).map((order) => (\r\n                                        <tr key={order.id}>\r\n                                            <td>{order.order_nr}</td>\r\n                                            <td>{order.tickets[0].name} {order.tickets[0].lastname}</td>\r\n                                            <td>\r\n                                                \r\n                                                {order.active === 0 && (\r\n                                                    <>\r\n                                                        <button className='btn btn-primary admin-table' onClick={() => handleAccept(order.id)}>Accept</button> \r\n                                                        <button className='btn btn-primary admin-table' onClick={() => handleCancel(order.id)}>Cancel</button>\r\n                                                    </>\r\n                                                )}\r\n                                                {order.active === 1 && (\r\n                                                    <p>Aktyvuotas</p>\r\n                                                )}\r\n                                                {order.active === 2 && (\r\n                                                    <p>Atšauktas</p>\r\n                                                )}\r\n                                            </td>\r\n                                        </tr>\r\n                                    ))}\r\n                                </tbody>\r\n                            </Table>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n            </>\r\n            }\r\n        </>\r\n    )\r\n}\r\n\r\nexport default Admin;"],"mappings":"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"},"metadata":{},"sourceType":"module"}